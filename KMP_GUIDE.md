# ğŸƒRunner's Hi KMP ê°œë°œ ê°€ì´ë“œ

**Kotlin Multiplatform (KMP)** í”„ë¡œì íŠ¸ì¸ **Runner's Hi**ì˜ ê°œë°œ ê°€ì´ë“œì…ë‹ˆë‹¤.

---

## ğŸ“š 1. KMP í”„ë¡œì íŠ¸ êµ¬ì¡° ì´í•´í•˜ê¸°

KMPëŠ” **"ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ê³µìœ í•˜ê³ (Shared), UIì™€ í”Œë«í¼ ê¸°ëŠ¥ì€ ë„¤ì´í‹°ë¸Œí•˜ê²Œ(Native)"** ê°œë°œí•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

### í´ë” êµ¬ì¡° ìš”ì•½
* **`shared/` (í•µì‹¬)**: ì•ˆë“œë¡œì´ë“œ, iOS, ì„œë²„ì—ì„œ ê³µìœ í•  ìˆ˜ ìˆëŠ” ì½”ë“œê°€ ìœ„ì¹˜í•©ë‹ˆë‹¤.
    * `commonMain`: ìˆœìˆ˜ Kotlin ì½”ë“œ (DTO, ë„ë©”ì¸ ëª¨ë¸, ê³µí†µ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§). **ëª¨ë“  í”Œë«í¼ì´ ê³µìœ í•©ë‹ˆë‹¤.**
    * `androidMain`, `iosMain`: ê³µí†µ ë¡œì§ ì¤‘ í”Œë«í¼ë³„ êµ¬í˜„ì´ í•„ìš”í•œ ì½”ë“œ (ì˜ˆ: ë¸”ë£¨íˆ¬ìŠ¤, íŒŒì¼ ì‹œìŠ¤í…œ ì ‘ê·¼ ë“±).
* **`server/`**: Spring Boot + Kotlin ê¸°ë°˜ì˜ ë°±ì—”ë“œ ì„œë²„ ëª¨ë“ˆì…ë‹ˆë‹¤.
* **`composeApp` (ë˜ëŠ” `androidApp`)**: ì•ˆë“œë¡œì´ë“œ ì•± í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.
* **`iosApp/`**: iOS ì•± í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. (Xcode í”„ë¡œì íŠ¸ êµ¬ì¡°)
* **`gradle/libs.versions.toml`**: í”„ë¡œì íŠ¸ì˜ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ê³¼ ì˜ì¡´ì„±ì„ ê´€ë¦¬í•˜ëŠ” íŒŒì¼ì…ë‹ˆë‹¤.

-----

## ğŸ“‚ 2. shared ë””ë ‰í„°ë¦¬ì— ë¬´ì—‡ì„ ë„£ì–´ì•¼ í•˜ë‚˜ìš”?

### ì„œë²„ ê°œë°œì

#### 1\. DTO

API í†µì‹ ì— ì‚¬ìš©í•˜ëŠ” Request/Response ëª¨ë¸ì…ë‹ˆë‹¤. ì´ê²ƒì„ ê³µìœ í•˜ë©´ **API ìŠ¤í™ ë¬¸ì„œ(Swagger ë“±)ë¥¼ ë³´ê³  ì½”ë“œë¥¼ ì¹  í•„ìš”ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤.**

* **ë°°ì¹˜ ìœ„ì¹˜:** `shared/src/commonMain/kotlin/good/space/runnershi/model/dto`

#### 2\. ìƒìˆ˜

ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ê°€ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ìƒíƒœ ê°’ì´ë‚˜ ì„¤ì • ê°’ì…ë‹ˆë‹¤.

* **ë°°ì¹˜ ìœ„ì¹˜:** `shared/src/commonMain/kotlin/good/space/runnershi/model/type`

#### 3\. ê³µí†µ ê²€ì¦ ë¡œì§

í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ ì–‘ìª½ì—ì„œ ë˜‘ê°™ì´ ê²€ì¦í•´ì•¼ í•˜ëŠ” ë¡œì§ì…ë‹ˆë‹¤.

* **ì˜ˆì‹œ:**
    * `PasswordValidator`: "ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒ, íŠ¹ìˆ˜ë¬¸ì í¬í•¨" ê·œì¹™ ê²€ì‚¬.
        * \-\> ëª¨ë°”ì¼: ì…ë ¥ ì‹œ ì‹¤ì‹œê°„ ë¶‰ì€ìƒ‰ ê²½ê³  í‘œì‹œìš©.
        * \-\> ì„œë²„: API ìš”ì²­ ë“¤ì–´ì™”ì„ ë•Œ ìµœì¢… ë°©ì–´ìš©.

#### 4\. âŒ `shared`ì— ë„£ìœ¼ë©´ ì•ˆ ë˜ëŠ” ê²ƒ

* **JPA Entity:** DBì™€ ê°•í•˜ê²Œ ê²°í•©ë˜ë¯€ë¡œ `server` ëª¨ë“ˆì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
* **Spring Bean / Service:** í”„ë ˆì„ì›Œí¬ ì˜ì¡´ì„±ì´ë¯€ë¡œ ê³µìœ  ë¶ˆê°€í•©ë‹ˆë‹¤.

-----

### ëª¨ë°”ì¼ ê°œë°œì

"í™”ë©´(UI)ì„ ì œì™¸í•œ ëª¨ë“  ì•±ì˜ ê¸°ëŠ¥"ì„ ë„£ìœ¼ë©´ ë©ë‹ˆë‹¤.

#### í†µì‹  ë¡œì§

ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ë¡œì§ì…ë‹ˆë‹¤.

* **ë°°ì¹˜ ìœ„ì¹˜:** `shared/src/commonMain/kotlin/good/space/runnershi/network`
* **ì—­í• :** `HttpClient`ë¥¼ ìƒì„±í•˜ê³ , APIë¥¼ í˜¸ì¶œí•˜ì—¬ DTOë¥¼ ë°›ì•„ì˜µë‹ˆë‹¤.
* **ì¥ì :** ì•ˆë“œë¡œì´ë“œì™€ iOSì—ì„œ ê°ê° í†µì‹  ë¡œì§ì„ êµ¬ì„±í•  í•„ìš”ê°€ ì—†ì–´ì§‘ë‹ˆë‹¤.

#### Local Database & Caching

ì•± ë‚´ë¶€ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë¡œì§ì…ë‹ˆë‹¤.

* **ë°°ì¹˜ ìœ„ì¹˜:** `shared/src/commonMain/kotlin/good/space/runnershi/database`
* **ì—­í• :** ì„œë²„ì—ì„œ ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ ë¡œì»¬ì— ìºì‹±í•˜ê±°ë‚˜, ì˜¤í”„ë¼ì¸ ëª¨ë“œë¥¼ ì§€ì›í•©ë‹ˆë‹¤.

#### ViewModels (Presentation Logic)

í™”ë©´ì— ë³´ì—¬ì¤„ ë°ì´í„°ë¥¼ ê°€ê³µí•˜ëŠ” ë¡œì§ì…ë‹ˆë‹¤. (KMPìš© ViewModel ì‚¬ìš©)

* **ë°°ì¹˜ ìœ„ì¹˜:** `shared/src/commonMain/kotlin/good/space/runnershi/viewmodel`
* **ì—­í• :** `StateFlow`ë¥¼ í†µí•´ UI ìƒíƒœë¥¼ ë°©ì¶œ(Emit)í•©ë‹ˆë‹¤.
    * Android(Compose)ëŠ” ì´ë¥¼ `collectAsState()`ë¡œ êµ¬ë….
    * iOS(SwiftUI)ëŠ” ì´ë¥¼ `SKIE`ë‚˜ `ObservableObject`ë¡œ êµ¬ë….

#### í”Œë«í¼ íŠ¹í™” ê¸°ëŠ¥

ê³µìœ í•˜ê³  ì‹¶ì§€ë§Œ, êµ¬í˜„ ë°©ë²•ì´ OSë§ˆë‹¤ ë‹¤ë¥¸ ê¸°ëŠ¥ì…ë‹ˆë‹¤.
- commonMainì— ê³µí†µ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‘ì„±í•˜ê³ , adroidMainê³¼ iosMainì— ê°ê° êµ¬í˜„ì²´ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

-----

### ğŸ“‚ ë””ë ‰í„°ë¦¬ êµ¬ì¡° ì˜ˆì‹œ

```text
shared/src/commonMain/kotlin/good/space/runnershi/
â”œâ”€â”€ model/                  <-- [ê³µí†µ] ì„œë²„/ëª¨ë°”ì¼ ëª¨ë‘ ì‚¬ìš©
â”‚   â”œâ”€â”€ dto/                (LoginRequest, UserDto)
â”‚   â”œâ”€â”€ type/               (UserRole Enum, Constants)
â”‚   â””â”€â”€ domain/             (ìˆœìˆ˜ User ê°ì²´)
â”‚
â”œâ”€â”€ validation/             <-- [ê³µí†µ] ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™
â”‚   â”œâ”€â”€ EmailValidator.kt   (ì •ê·œì‹ ê²€ì‚¬ ë“±)
â”‚   â””â”€â”€ PolicyChecker.kt
â”‚
â”œâ”€â”€ network/                <-- [ëª¨ë°”ì¼ ì£¼ë„] API í†µì‹ 
â”‚   â”œâ”€â”€ AuthApi.kt          (Ktor API Call)
â”‚   â””â”€â”€ ApiClient.kt
â”‚
â”œâ”€â”€ database/               <-- [ëª¨ë°”ì¼ ì£¼ë„] ë¡œì»¬ ì €ì¥ì†Œ
â”‚   â””â”€â”€ AppDatabase.kt      (Room/SQLDelight)
â”‚
â””â”€â”€ viewmodel/              <-- [ëª¨ë°”ì¼ ì£¼ë„] UI ìƒíƒœ ê´€ë¦¬
    â””â”€â”€ LoginViewModel.kt   (ë¡œê·¸ì¸ ë¡œì§, StateFlow)
```

-----

### ğŸš€ ê°œë°œ ì›Œí¬í”Œë¡œìš°(ìš”ì•½)

1.  **ê¸°íš ë‹¨ê³„:** ì„œë²„/ëª¨ë°”ì¼ ê°œë°œìê°€ ëª¨ì—¬ **DTOì™€ Enum**ì„ ì •ì˜í•˜ê³  `shared`ì— ì‘ì„±í•©ë‹ˆë‹¤.
2.  **ì„œë²„ ê°œë°œ:** `server` ëª¨ë“ˆì—ì„œ `shared`ì˜ DTOë¥¼ ê°€ì ¸ì™€ ì»¨íŠ¸ë¡¤ëŸ¬(`@RequestBody`)ì—ì„œ ì‚¬ìš©í•©ë‹ˆë‹¤.
3.  **ëª¨ë°”ì¼ ê°œë°œ:** `shared`ì˜ `network` ì½”ë“œë¥¼ ì´ìš©í•´ ì„œë²„ì— ìš”ì²­ì„ ë³´ë‚´ê³ , `viewmodel`ì—ì„œ ë¡œì§ì„ ì²˜ë¦¬í•˜ì—¬ UIì— ë¿Œë¦½ë‹ˆë‹¤.

---

## ğŸ”‘ 4. í™˜ê²½ë³€ìˆ˜ ì„¤ì • (Environment Variables)

ì´ í”„ë¡œì íŠ¸ëŠ” ë³´ì•ˆìƒ ë¯¼ê°í•œ ì •ë³´(DB ë¹„ë°€ë²ˆí˜¸, API Key ë“±)ë¥¼ ì½”ë“œì— ì§ì ‘ í¬í•¨í•˜ì§€ ì•Šê³ , í™˜ê²½ë³€ìˆ˜(.env)ë¥¼ í†µí•´ ê´€ë¦¬í•©ë‹ˆë‹¤.
ì„œë²„ëŠ” build.gradle.kts ì„¤ì •ì— ì˜í•´ bootRunì‹œ ìë™ìœ¼ë¡œ í™˜ê²½ë³€ìˆ˜ë¥¼ ë¡œë“œí•©ë‹ˆë‹¤.
ëª¨ë°”ì¼ì€ gradle.properties í˜¹ì€ local.propertiesë¥¼ í†µí•´ ë³„ë„ë¡œ ì£¼ì…í•´ ë¡œë“œí•©ë‹ˆë‹¤.

### ì„¤ì • ìˆœì„œ

1. application.ymlì— í™˜ê²½ë³€ìˆ˜ë¥¼ ì„ ì–¸í•©ë‹ˆë‹¤. (ex_ `secret_key: ${SECRET_KEY}`)
2. í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— ìˆëŠ” `.env.example` íŒŒì¼ì„ ë³µì‚¬í•˜ì—¬ `.env` íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.
3. `.env` íŒŒì¼ì— ì‹¤ì œ ê°’ì„ ì…ë ¥í•©ë‹ˆë‹¤.

> **ì£¼ì˜:** íŒ€ì›ê³¼ ê³µìœ í•´ì•¼ í•  ìƒˆë¡œìš´ í™˜ê²½ë³€ìˆ˜ê°€ ìƒê¸°ë©´, ë°˜ë“œì‹œ `.env.example` íŒŒì¼ì—ë„ ë°˜ì˜í•´ì£¼ì„¸ìš”.

-----

## ğŸ“¦ 5. ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ì„± ì¶”ê°€ ë°©ë²•

ì´ í”„ë¡œì íŠ¸ëŠ” **Version Catalog (`libs.versions.toml`)** ë°©ì‹ì„ ì‚¬ìš©í•˜ì—¬ ì˜ì¡´ì„±ì„ ê´€ë¦¬í•©ë‹ˆë‹¤. `build.gradle.kts`ì— ì§ì ‘ ë²„ì „ì„ ì ì§€ ë§ˆì„¸ìš”.

### Step 1. Version Catalogì— ì •ì˜í•˜ê¸°

`gradle/libs.versions.toml` íŒŒì¼ì„ ì—´ê³  ë²„ì „ê³¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

```toml
[versions]
myLibrary = "1.2.3"

[libraries]
# ì‚¬ìš©í•  ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ë¦„ = { module = "ê·¸ë£¹:ì•„í‹°íŒ©íŠ¸", version.ref = "ìœ„ì—ì„œ_ì •ì˜í•œ_ë²„ì „í‚¤" }
my-awesome-lib = { module = "com.example:awesome-lib", version.ref = "myLibrary" }
```

### Step 2. ëª¨ë“ˆì— ì ìš©í•˜ê¸°

ì‚¬ìš©í•˜ë ¤ëŠ” ëª¨ë“ˆ(ì˜ˆ: `shared`, `server`)ì˜ `build.gradle.kts` íŒŒì¼ì„ ì—´ê³  ì˜ì¡´ì„±ì„ ì¶”ê°€í•©ë‹ˆë‹¤.

**Case A: ëª¨ë“  í”Œë«í¼ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¡œì§ (Shared/commonMain)**

```kotlin
// shared/build.gradle.kts
kotlin {
    sourceSets {
        commonMain.dependencies {
            implementation(libs.my.awesome.lib) // . ëŒ€ì‹  - ëŠ” . ìœ¼ë¡œ ìë™ ë³€í™˜ë¨
        }
    }
}
```

**Case B: ì„œë²„ì—ì„œë§Œ ì‚¬ìš©í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ (Server)**

```kotlin
// server/build.gradle.kts
dependencies {
    implementation(libs.my.awesome.lib)
}
```
